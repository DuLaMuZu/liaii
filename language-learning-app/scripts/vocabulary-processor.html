<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¯æ±‡æ•°æ®å¤„ç†å·¥å…·</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #0ea5e9;
            padding-bottom: 10px;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .input-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #555;
        }
        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            box-sizing: border-box;
        }
        textarea {
            min-height: 200px;
            font-family: 'Courier New', monospace;
        }
        button {
            background-color: #0ea5e9;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin-right: 10px;
        }
        button:hover {
            background-color: #0284c7;
        }
        button.secondary {
            background-color: #6b7280;
        }
        button.secondary:hover {
            background-color: #4b5563;
        }
        .output {
            background-color: #f9fafb;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #e5e7eb;
            margin-top: 10px;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        .stat-card h3 {
            margin: 0 0 10px 0;
            font-size: 14px;
            opacity: 0.9;
        }
        .stat-card .number {
            font-size: 32px;
            font-weight: bold;
        }
        .instructions {
            background-color: #eff6ff;
            border-left: 4px solid #0ea5e9;
            padding: 15px;
            margin-bottom: 20px;
        }
        .warning {
            background-color: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin-bottom: 20px;
        }
        .example {
            background-color: #f0fdf4;
            border: 1px solid #86efac;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
        }
        .progress {
            width: 100%;
            height: 8px;
            background-color: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-bar {
            height: 100%;
            background-color: #0ea5e9;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <h1>ğŸ“š è¯­è¨€å­¦ä¹ ç³»ç»Ÿ - è¯æ±‡æ•°æ®å¤„ç†å·¥å…·</h1>

    <div class="instructions">
        <h3>ğŸ“‹ ä½¿ç”¨è¯´æ˜</h3>
        <p>1. ç²˜è´´è‹±æ–‡å•è¯åˆ—è¡¨ï¼ˆæ¯è¡Œä¸€ä¸ªå•è¯ï¼Œæˆ–åŒ…å«å®šä¹‰ï¼‰</p>
        <p>2. é€‰æ‹©è¯æ±‡æ¥æºå’Œçº§åˆ«</p>
        <p>3. ç‚¹å‡»"å¤„ç†è¯æ±‡"è‡ªåŠ¨ç”Ÿæˆæ•°æ®ç»“æ„</p>
        <p>4. å¤åˆ¶ç”Ÿæˆçš„TypeScriptä»£ç åˆ°é¡¹ç›®ä¸­</p>
    </div>

    <div class="container">
        <h2>æ­¥éª¤1: è¾“å…¥è¯æ±‡æ•°æ®</h2>

        <div class="input-group">
            <label>è¾“å…¥æ ¼å¼ç¤ºä¾‹ï¼š</label>
            <div class="example">
table | n. | A piece of furniture with a flat top
chair | n. | A seat for one person
æˆ–ç®€å•æ ¼å¼ï¼š
table
chair
happy
            </div>
        </div>

        <div class="input-group">
            <label for="rawInput">ç²˜è´´è¯æ±‡åˆ—è¡¨ï¼š</label>
            <textarea id="rawInput" placeholder="æ¯è¡Œä¸€ä¸ªå•è¯ï¼Œå¯é€‰ï¼šå•è¯ | è¯æ€§ | è‹±æ–‡å®šä¹‰"></textarea>
        </div>

        <div class="input-group">
            <label for="source">è¯æ±‡æ¥æºï¼š</label>
            <select id="source">
                <option value="oxford_3000">Oxford 3000</option>
                <option value="awl">Academic Word List (AWL)</option>
                <option value="gre_357">GRE 357</option>
            </select>
        </div>

        <div class="input-group">
            <label for="level">é»˜è®¤çº§åˆ«ï¼š</label>
            <select id="level">
                <option value="A1">A1 (å…¥é—¨)</option>
                <option value="A2">A2 (åˆçº§)</option>
                <option value="B1" selected>B1 (ä¸­çº§)</option>
                <option value="B2">B2 (ä¸­é«˜çº§)</option>
                <option value="C1">C1 (é«˜çº§)</option>
                <option value="C2">C2 (ç²¾é€š)</option>
            </select>
        </div>

        <button onclick="processVocabulary()">ğŸš€ å¤„ç†è¯æ±‡</button>
        <button class="secondary" onclick="clearAll()">ğŸ—‘ï¸ æ¸…ç©º</button>
    </div>

    <div id="statsContainer" style="display:none;">
        <div class="stats">
            <div class="stat-card">
                <h3>å·²å¤„ç†å•è¯</h3>
                <div class="number" id="wordCount">0</div>
            </div>
            <div class="stat-card">
                <h3>å¹³å‡è·ç¦»åˆ†æ•°</h3>
                <div class="number" id="avgDistance">0.00</div>
            </div>
            <div class="stat-card">
                <h3>éœ€è¦ç¿»è¯‘</h3>
                <div class="number" id="needTranslation">0</div>
            </div>
        </div>
    </div>

    <div class="container" id="outputContainer" style="display:none;">
        <h2>æ­¥éª¤2: ç”Ÿæˆçš„TypeScriptä»£ç </h2>

        <div class="warning">
            <strong>âš ï¸ æ³¨æ„ï¼š</strong>ç”Ÿæˆçš„æ•°æ®ä¸­ï¼Œä¸­æ–‡ç¿»è¯‘æ ‡è®°ä¸º"å¾…ç¿»è¯‘"ï¼Œéœ€è¦æ‰‹åŠ¨è¡¥å……æˆ–ä½¿ç”¨ç¿»è¯‘APIã€‚
        </div>

        <div class="progress">
            <div class="progress-bar" id="progressBar" style="width: 0%"></div>
        </div>

        <button onclick="copyOutput()">ğŸ“‹ å¤åˆ¶ä»£ç </button>
        <button class="secondary" onclick="downloadJSON()">ğŸ’¾ ä¸‹è½½JSON</button>
        <button class="secondary" onclick="addTranslations()">ğŸŒ æ·»åŠ ç¿»è¯‘ (éœ€è¦API)</button>

        <div class="output">
            <pre id="output"></pre>
        </div>
    </div>

    <div class="container">
        <h2>æ­¥éª¤3: AIè¾…åŠ©ç¿»è¯‘</h2>
        <p>å¯ä»¥å°†ç”Ÿæˆçš„JSONæ•°æ®å‘é€ç»™AIï¼ˆå¦‚ChatGPTã€Claudeï¼‰æ¥æ·»åŠ ä¸­æ–‡ç¿»è¯‘ï¼š</p>
        <div class="example">
æç¤ºè¯æ¨¡æ¿ï¼š
è¯·ä¸ºä»¥ä¸‹è‹±æ–‡å•è¯æ·»åŠ å‡†ç¡®çš„ä¸­æ–‡ç¿»è¯‘ï¼ˆå¯ä»¥æœ‰å¤šä¸ªå¯¹åº”è¯ï¼‰ï¼š
[ç²˜è´´ç”Ÿæˆçš„å•è¯åˆ—è¡¨]

å¯¹äºæ¯ä¸ªå•è¯ï¼Œè¯·æä¾›ï¼š
1. æœ€å¸¸ç”¨çš„1-3ä¸ªä¸­æ–‡å¯¹åº”è¯
2. å¦‚æœæ˜¯å¤šä¹‰è¯ï¼Œåˆ—å‡ºä¸»è¦å«ä¹‰çš„ä¸­æ–‡ç¿»è¯‘
3. æ ‡æ³¨å“ªäº›è¯æ±‡åœ¨ä¸­è‹±æ–‡åŒ–ä¸­æœ‰æ˜¾è‘—å·®å¼‚ï¼ˆæ¨¡ç³Šæ¦‚å¿µï¼‰
        </div>
    </div>

    <script>
        let processedData = [];

        function parseVocabularyLine(line) {
            line = line.trim();
            if (!line) return null;

            const parts = line.split('|').map(p => p.trim());

            if (parts.length >= 3) {
                return {
                    english: parts[0],
                    partOfSpeech: parts[1] || 'n.',
                    englishDefinition: parts[2] || ''
                };
            } else {
                return {
                    english: parts[0],
                    partOfSpeech: 'n.',
                    englishDefinition: ''
                };
            }
        }

        function calculateDistanceScore(english, chinese = 'å¾…ç¿»è¯‘') {
            // ç®€åŒ–çš„è¯„åˆ†è®¡ç®—
            const meaningDistance = 0.15; // é»˜è®¤å€¼
            const visualDistance = Math.min(1, 1 - Math.exp(-Math.abs(chinese.length * 12 - english.length) / 10));
            const pronunciationDistance = english.length <= 5 ? 0.75 : english.length <= 10 ? 0.85 : 0.95;

            return {
                meaningDistance: meaningDistance,
                visualDistance: visualDistance,
                pronunciationDistance: pronunciationDistance,
                distanceScore: 0.4 * meaningDistance + 0.3 * visualDistance + 0.3 * pronunciationDistance
            };
        }

        function processVocabulary() {
            const rawInput = document.getElementById('rawInput').value;
            const source = document.getElementById('source').value;
            const level = document.getElementById('level').value;

            const lines = rawInput.split('\n').filter(line => line.trim());

            if (lines.length === 0) {
                alert('è¯·è¾“å…¥è¯æ±‡æ•°æ®ï¼');
                return;
            }

            processedData = [];
            let idCounter = 1;

            for (const line of lines) {
                const parsed = parseVocabularyLine(line);
                if (!parsed) continue;

                const scores = calculateDistanceScore(parsed.english);

                const concept = {
                    id: `clear-${source}-${String(idCounter).padStart(4, '0')}`,
                    type: 'clear',
                    english: parsed.english,
                    partOfSpeech: parsed.partOfSpeech,
                    chinese: ['å¾…ç¿»è¯‘'],
                    englishDefinition: parsed.englishDefinition || `Definition for ${parsed.english} (needs to be added)`,
                    exampleSentence: '',
                    source: source,
                    level: level,
                    ...scores
                };

                processedData.push(concept);
                idCounter++;
            }

            displayResults();
        }

        function displayResults() {
            const output = document.getElementById('output');
            const statsContainer = document.getElementById('statsContainer');
            const outputContainer = document.getElementById('outputContainer');

            // æ˜¾ç¤ºç»Ÿè®¡
            document.getElementById('wordCount').textContent = processedData.length;
            const avgDist = processedData.reduce((sum, c) => sum + c.distanceScore, 0) / processedData.length;
            document.getElementById('avgDistance').textContent = avgDist.toFixed(2);
            const needTrans = processedData.filter(c => c.chinese[0] === 'å¾…ç¿»è¯‘').length;
            document.getElementById('needTranslation').textContent = needTrans;

            statsContainer.style.display = 'block';
            outputContainer.style.display = 'block';

            // ç”ŸæˆTypeScriptä»£ç 
            const tsCode = `import type { Concept } from '../types';
import { scoreCleanConcept } from '../lib/scoring/distance';

// è‡ªåŠ¨ç”Ÿæˆçš„è¯æ±‡æ•°æ® - ${new Date().toLocaleDateString()}
// æ¥æº: ${document.getElementById('source').value}
// æ€»è®¡: ${processedData.length} ä¸ªè¯æ±‡

export const generatedConcepts: Concept[] = ${JSON.stringify(processedData, null, 2)};

// å¯¼å‡ºåˆ°ä¸»è¯æ±‡æ–‡ä»¶
// å°†æ­¤æ•°ç»„æ·»åŠ åˆ° src/data/allVocabulary.ts
`;

            output.textContent = tsCode;

            // æ›´æ–°è¿›åº¦æ¡
            document.getElementById('progressBar').style.width = '100%';
        }

        function copyOutput() {
            const output = document.getElementById('output');
            navigator.clipboard.writeText(output.textContent);
            alert('âœ… ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
        }

        function downloadJSON() {
            const dataStr = JSON.stringify(processedData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `vocabulary-${document.getElementById('source').value}-${Date.now()}.json`;
            link.click();
            URL.revokeObjectURL(url);
            alert('âœ… JSONæ–‡ä»¶å·²ä¸‹è½½ï¼');
        }

        function addTranslations() {
            alert('ğŸ’¡ æç¤ºï¼šå°†ç”Ÿæˆçš„è¯æ±‡åˆ—è¡¨å¤åˆ¶ç»™AIåŠ©æ‰‹ï¼Œè¦æ±‚æ·»åŠ ä¸­æ–‡ç¿»è¯‘ã€‚\n\nç¤ºä¾‹æç¤ºè¯ï¼š\n"è¯·ä¸ºè¿™äº›è‹±æ–‡å•è¯æ·»åŠ å‡†ç¡®çš„ä¸­æ–‡ç¿»è¯‘ï¼ˆ1-3ä¸ªå¸¸ç”¨è¯ï¼‰ï¼š\n' +
                  processedData.slice(0, 5).map(c => c.english).join(', ') + '..."');
        }

        function clearAll() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿ')) {
                document.getElementById('rawInput').value = '';
                document.getElementById('output').textContent = '';
                processedData = [];
                document.getElementById('statsContainer').style.display = 'none';
                document.getElementById('outputContainer').style.display = 'none';
            }
        }
    </script>
</body>
</html>
